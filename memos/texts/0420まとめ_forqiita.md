4/19~4/20に**Cursor**を利用して「**AIとの共同作業**」をテーマに個人開発の基本設計書の作成作業を行いました。
それにあたって有効に感じた方針やその意図、感想などをまとめた資料となります。

# 基本設計書に用いたツール等
IDE: Cursor
AIモデル: Claude 3.7 Sonnet, Gemini 2.5 Pro

# 作成中の基本設計書
[Github](https://github.com/thsic/RealtimeBusTracker/tree/main/docs/基本設計)

# Cursorとは？
VSCodeをベースに開発されたAI統合型のコードエディタです。
コードを自動で推測してくれるCopilotや指示を元にAIが自律的にコードを生成してくれるAgent機能などが備わっています。
無料でも使えますが、しっかり使うのであれば**Pro版**がおすすめです。**月3000円**しますが……。

※ 無料でAI開発を行うのであれば拡張機能でPro版機能の代替をするというアプローチも良いと思います。以下記事が参考になります。
[Cursor の無料版を使い続ける場合の設定](https://qiita.com/7shi/items/2e8e3ed2c39e3dc4ee22?utm_campaign=post_article&utm_medium=twitter&utm_source=twitter_share)

# Cursorの画面
![073.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/411501/c8a4467f-d4b0-4a15-81a5-d8bf2bd4a77b.png)

**黄色枠**: エクスプローラー
**緑枠**  : エディタ
**赤枠**  : AIとのチャット欄

チャット欄でAIに資料作成の内容などを指示すると、それに従って資料を作成してくれます。

基本設計書の作成風景としてエディタで文章を書くことをご想像されるかと思いますが、**実際はエディタで文字を書くことはほぼ無く**、ほとんど全ての作成作業をチャット欄で行いました。
そうしてAIが生成した資料をエディタでレビューするというのが基本的な流れです。

# 環境と方針
AIに適切に資料作成してもらうには**AIにとって都合のいい環境を作ってあげることが大切であると思います**。試行錯誤の中でそれなりに良い方針ができたと思うので共有します。

（流動的に変わっていく部分ではあると思うのですが、とりあえず現状の考えを共有します）

# 環境の方針
### 情報はできる限りテキスト形式で指示・保存する
AIはトークン（人間で言う単語）を保持できる量に限りがあり、その上限に近づくと**情報の抜け落ち**が発生します。
基本的に画像や動画はテキストよりも多くのトークンが必要なため、たくさんの情報を保持するためにトークンに対して情報密度が高い**テキスト形式でインプットを行うのが望ましい**です。

AIに詳しい方であれば、プロンプトはマークダウンで書くことが推奨されることをご存知の方もいらっしゃるかもしれません。
マークダウンは実際にはテキスト形式のため情報密度が高いことに加えて、強調表現やテーブルなどによってAIにとって**意図が理解しやすい形**で情報を表現できることが理由です。

Chatbotのアウトプットは基本的にマークダウンなので、イン・アウトが統一できる点も嬉しいです。

#### 参考
ERDなどもMermaidを使えばマークダウンで表現することが可能です。
まだ初期状態の図ではありますが、私が実際にAIに頼んで生成してもらったものを示します。

![074.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/411501/6985ecf5-2252-421a-b2c6-9e33659ca059.png)

上記の図は実際には下記のテキストによって表現されています。
```
erDiagram
    BUS_STOP ||--o{ OPERATION_HISTORY : "保有する"
    BUS_STOP ||--o{ FAVORITE_ROUTE : "含まれる"
    BUS_STOP {
        string バス停ID PK
        string バス停名
        float 緯度
        float 経度
        boolean お気に入りフラグ
    }
    OPERATION_HISTORY {
        string 履歴ID PK
        string バス停ID FK
        datetime 到着時刻
        int 遅延時間
        int 曜日
        string 時間帯
        int 混雑度 "混雑度(例: 0-2 空/中/混)"
    }
    FAVORITE_ROUTE {
        string ルートID PK
        string 出発バス停ID FK
        string 到着バス停ID FK
        string ルート名
    }
```

### フォルダ構造、ファイル名は内容を明確に表すように命名する
AIは必要に応じてファイルの探索を行います。
その際ファイル名などから資料内容のあたりを付けながら読んでもらうため、またトークンを無駄に使わせないためにフォルダ名とファイル名はそれらの内容物を**明確に表すよう命名**します。

また、ファイルの内容に関してもセクション毎に適切に切り分けることを意識します。

### バージョン管理ツールを使う
Githubでファイルの管理を行いました。
バージョン管理ツールは「**AIに自由に動いてもらうこと**」と「**資料の質**」を両立するために必要だと思っています。

資料はマークダウンで管理するため、変更箇所の参照も容易です。

設定によってはAIが自動でコミットやプルリクエストまでも行ってくれるようです。
（私は少し怖かったので禁止コマンドリストに`git`を指定しており、この挙動は確認できてないです）

### ファイル毎にAI用のメモ欄を用意する
補足と題してファイル毎にAI用のメモ書き欄を作成して、そこに自由にメモ書きを残してもらうようにしていました。
補足欄では資料に書くほどでもないけれど知識として知っておきたいというレベルの情報を残して貰い、次回以降資料を参照してもらう時や改修してもらう時に役立ててもらうための場所です。

![076.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/411501/398ea2f0-29b6-4697-a058-c31a9e3d1eeb.png)

人間に読ませる気を感じさせないカラム名の羅列がAI専用メモ欄という感じがしてとてもいいですね。


# プロンプトの書き方の方針
### とにかく情報量を増やす
詰めていきたい部分ではニュアンスを正確に伝えるために少しでも多く情報を書いた方が良いという考え方です。

ただし、昨今のAIモデルは賢くなっており「推論から期待する出力をしてくるためプロンプトは少なくて良い」という意見もあります。

実施して欲しいことだけを書くより**なぜそうして欲しいか**も含めて書くことで、プロンプト上で言語化できていない部分も含めて意図を汲み取って貰いやすくなります。
※ただし、意図を汲み取りすぎて違う方向に向かうこともあるので要調整です。

関連する資料を参照させることで、プロンプトを書くこと無く与える情報量を増やすこともできます。

### 行ってもらいたいことを具体的に書く
プロンプトの具体度が高いほど期待する出力を行ってくれやすくなります。
具体的なプロンプトを書ければ良いのですが、それが難しい場合はAIと一緒に悩んだり質問を行ってヒントを探ります。

### 特に正確性が求められる資料では生成後に複数回チェックを行う
外部から取得するAPIの資料化で行いました。Webの情報と比較して修正点があれば修正してもらい、ほとんど修正項目が出なくなるまで繰り返します。

![075.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/411501/8980979d-effa-43ef-8a79-258b8ed2568d.png)

[10_GTFS-RTデータ仕様書.md](https://github.com/thsic/RealtimeBusTracker/blob/main/docs/基本設計/10_GTFS-RTデータ仕様書.md)

### 軽微な修正であってもAIに行わせる
連動して修正が必要な資料の探索や、その後のプロンプトにおいてこちらの意図を理解してもらいやすくすることが目的です。

### プロンプトの記録
参考になるかは分かりませんが、[こちら](https://github.com/thsic/RealtimeBusTracker/blob/main/memos/texts/バス情報取得アプリ制作.md)にリアルタイムでAIとの格闘の様子を記した記録があります。ほぼ全てのプロンプトの記録を残しているのでよければご参照ください。
ちなみに15000文字あります（！）

# まとめ
## 環境
- 情報はできる限りテキスト形式で指示・保存する
    - できる限りマークダウン形式で指示する
    - 生成物はすべてテキスト形式にする
        - 基本的にマークダウン形式で出力する
        - ER図などはMermaidで出力する
        - 画面設計書はhtml + cssで出力する
- フォルダ構造、ファイル名は内容を明確に表すよう命名する
    - ファイルの内容もセクション毎に適切に切り分けることを意識する
- バージョン管理ツールを使う
- ファイル毎にAI用のメモ欄を用意する

## プロンプトの書き方
- とにかく情報量を増やす（賛否有）
    - 何のための作業なのかを書く
    - 参照して欲しい資料があるなら明確にする
    - プロンプトが長くなるのは問題ない
- プロンプトは行ってもらいたいことを具体的に書く
    - 具体的な指示が出来ないならAIと一緒に具体案を考える
- 特に正確性が求められる資料では生成後に複数回チェックを行う
- 軽微な修正であってもAIに行わせる

# 感想
## AIを"育てる"感覚
Web等でのChatbotツールではやり取りは一時的なもので、新たな会話を始めるたびにAIはそれまでのやり取りを忘れてしまいます。
それはそれで良い部分もあるのですが、**同じ回答が何度も表示されてうんざり**することもあります。

今回の設計書の制作では**基本設計書が記憶媒体**としての役割を果たすので、上記のようなことは起きづらかったです。

資料やメモが蓄積されるにつれ出力が改善される様子は、さながら**よくできた後輩を育てている感覚**があり、超スピードで成長していくAI後輩の姿を見ることは特有の楽しさがありました。

AIを触ったことで単純に時間と実力不足で諦めていたことが「**もしかしたらできるかも**」に変わったり、AIを絡めた新しいアイデアも思い浮かんできて、AIを触る前と後でやれそうなことの**射程がぐっと広がりました**。

体験としてもとても面白かったので興味のあるかたは触ってみてはいかがでしょうか……！

# おわりに
AI時代、トレンドの移り変わりが激しく情報を上手に収集することが難しいです。

**キャッチーで聞こえがいい情報**に流されやすくなりますが、情報の取捨選択こそエンジニアの腕の見せどころだと思うので培った勘を活かしたい部分です。

経験が浅いエンジニアでもシニアエンジニアに太刀打ちできる数少ないタイミングかと思うのでなんとか頑張りたいですね。

「**環境構築教えろ！！**」や「**AIでこれ作りたいからやり方考えろ！！**」など私で良ければ一緒に悩みますので気兼ねなくご連絡ください〜。
「**お前ここ間違ってるぞ！！**」などのクレームも大歓迎です！
よろしくお願いします<3

## おまけ
### AIモデルの評価
意図の汲み取りやWebからの情報取得の精度において、Claude 3.7 Sonnetより**Gemini 2.5 Pro**の方が優れていると感じました。
資料作成においてはGemini 2.5 Proを用いる予定です。
Claude 3.7 Sonnetは**コーディングが得意**らしいのでそちらも楽しみですね。
[ArtificialAnalysisによるモデル評価](https://artificialanalysis.ai/models/)